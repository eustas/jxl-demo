(()=>{const o={"client_worker.js":'const onmessage=function(o){console.log(o.data)},onLoadJxlModule=o=>{console.log("onLoadJxlModule")};importScripts("jxl_decoder.js"),console.log("before construct"),JxlCodecModule.mainScriptUrlOrBlob="https://jxl-demo.netlify.app/jxl_decoder.js",JxlCodecModule().then(onLoadJxlModule);',"jxl_decoder.js":'var JxlCodecModule=(()=>{var Re="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0;return"undefined"!=typeof __filename&&(Re=Re||__filename),function(e){e=e||{},console.log("MODULE");var r,i,t,a,n,s=void 0!==e?e:{},O=(s.ready=new Promise(function(e,t){r=e,i=t}),Object.assign({},s)),o=(e,t)=>{throw t},u="object"==typeof window,c="function"==typeof importScripts,l="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,_=s.ENVIRONMENT_IS_PTHREAD||!1,p="";function U(e){return console.log("locateFile "+e),s.locateFile?s.locateFile(e,p):p+e}if(l){var d,B,p=c?require("path").dirname(p)+"/":__dirname+"/";"function"==typeof require&&(d=require("fs"),B=require("path")),t=(e,t)=>(e=B.normalize(e),d.readFileSync(e,t?void 0:"utf8")),n=e=>{e=t(e,!0);return e=e.buffer?e:new Uint8Array(e)},a=(e,r,n)=>{e=B.normalize(e),d.readFile(e,function(e,t){e?n(e):r(t.buffer)})},1<process.argv.length&&process.argv[1].replace(/\\\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(e){if(!(e instanceof M))throw e}),process.on("unhandledRejection",function(e){throw e}),o=(e,t)=>{if(w)throw process.exitCode=e,t;(t=t)instanceof M||g("exiting due to exception: "+t),process.exit(e)},s.inspect=function(){return"[Emscripten Module object]"};let e;try{e=require("worker_threads")}catch(e){throw console.error(\'The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?\'),e}global.Worker=e.Worker}else(u||c)&&(c?p=self.location.href:"undefined"!=typeof document&&document.currentScript&&(p=document.currentScript.src),p=0!==(p=Re?Re:p).indexOf("blob:")?p.substr(0,p.replace(/[?#].*/,"").lastIndexOf("/")+1):"",l||(t=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},c&&(n=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),a=(e,t,r)=>{var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=()=>{200==n.status||0==n.status&&n.response?t(n.response):r()},n.onerror=r,n.send(null)}),0);l&&"undefined"==typeof performance&&(global.performance=require("perf_hooks").performance);var f,h,F,m=console.log.bind(console),y=console.warn.bind(console),D=(l&&(m=e=>d.writeSync(1,e+"\\n"),y=e=>d.writeSync(2,e+"\\n")),s.print||m),g=s.printErr||y,w=(Object.assign(s,O),s.arguments&&s.arguments,s.thisProgram&&s.thisProgram,s.quit&&(o=s.quit),Atomics.load,Atomics.store,Atomics.compareExchange,s.wasmBinary&&(f=s.wasmBinary),s.noExitRuntime||!0),H=("object"!=typeof WebAssembly&&T("no native wasm support detected"),!1);var v,x,b,k,A,L,N="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function z(e,t,r){for(var n=t+r,o=t;e[o]&&!(n<=o);)++o;if(16<o-t&&e.buffer&&N)return N.decode(e.buffer instanceof SharedArrayBuffer?e.slice(t,o):e.subarray(t,o));for(var i="";t<o;){var a,s,u=e[t++];128&u?(s=63&e[t++],192==(224&u)?i+=String.fromCharCode((31&u)<<6|s):(a=63&e[t++],(u=224==(240&u)?(15&u)<<12|s<<6|a:(7&u)<<18|s<<12|a<<6|63&e[t++])<65536?i+=String.fromCharCode(u):(s=u-65536,i+=String.fromCharCode(55296|s>>10,56320|1023&s)))):i+=String.fromCharCode(u)}return i}_&&(v=s.buffer);var J,m=s.INITIAL_MEMORY||78643200;if(_)h=s.wasmMemory,v=s.buffer;else if(s.wasmMemory)h=s.wasmMemory;else if(!((h=new WebAssembly.Memory({initial:m/65536,maximum:m/65536,shared:!0})).buffer instanceof SharedArrayBuffer))throw g("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),l&&g("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and also use a recent version)"),Error("bad memory");m=(v=h?h.buffer:v).byteLength,v=y=v,s.HEAP8=x=new Int8Array(y),s.HEAP16=new Int16Array(y),s.HEAP32=k=new Int32Array(y),s.HEAPU8=b=new Uint8Array(y),s.HEAPU16=new Uint16Array(y),s.HEAPU32=A=new Uint32Array(y),s.HEAPF32=new Float32Array(y),s.HEAPF64=L=new Float64Array(y);var Q=[],G=[],X=[];function V(){return w}function Y(){if(s.preRun)for("function"==typeof s.preRun&&(s.preRun=[s.preRun]);s.preRun.length;)e=s.preRun.shift(),Q.unshift(e);var e;ue(Q)}function K(){_||ue(G)}function Z(){if(!_){if(s.postRun)for("function"==typeof s.postRun&&(s.postRun=[s.postRun]);s.postRun.length;)e=s.postRun.shift(),X.unshift(e);var e;ue(X)}}var W=0,$=null,j=null;function T(e){_?postMessage({cmd:"onAbort",arg:e}):s.onAbort&&s.onAbort(e),g(e="Aborted("+e+")"),H=!0,e+=". Build with -sASSERTIONS for more info.";e=new WebAssembly.RuntimeError(e);throw i(e),e}var S;function ee(e){return e.startsWith("data:application/octet-stream;base64,")}function te(e){return e.startsWith("file://")}function re(e){try{if(e==S&&f)return new Uint8Array(f);if(n)return n(e);throw"both async and sync fetching of the wasm failed"}catch(e){T(e)}}ee(S="jxl_decoder.wasm")||(S=U(S));var ne={};function M(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function oe(e){var t,e=P.pthreads[e];e||T(t),P.returnWorkerToPool(e)}function ie(e){var t=P.getNewWorker();if(!t)return 6;P.runningWorkers.push(t),(P.pthreads[e.pthread_ptr]=t).pthread_ptr=e.pthread_ptr;var r={cmd:"run",start_routine:e.startRoutine,arg:e.arg,pthread_ptr:e.pthread_ptr};return t.runPthread=()=>{r.time=performance.now(),t.postMessage(r,e.transferList)},t.loaded&&(t.runPthread(),delete t.runPthread),0}function ae(e){if(_)return R(1,1,e);w||(P.terminateAllThreads(),s.onExit&&s.onExit(e),H=!0),o(e,new M(e))}var se=function(e,t){if(!t&&_)throw ce(e),"unwind";ae(e)};var P={unusedWorkers:[],runningWorkers:[],tlsInitFunctions:[],pthreads:{},init:function(){_?P.initWorker():P.initMainThread()},initMainThread:function(){for(var e=4;e--;)P.allocateUnusedWorker()},initWorker:function(){w=!1},setExitStatus:function(e){0},terminateAllThreads:function(){for(var e of Object.values(P.pthreads))P.returnWorkerToPool(e);for(var e of P.unusedWorkers)e.terminate();P.unusedWorkers=[]},returnWorkerToPool:function(e){var t=e.pthread_ptr;delete P.pthreads[t],P.unusedWorkers.push(e),P.runningWorkers.splice(P.runningWorkers.indexOf(e),1),e.pthread_ptr=0,We(t)},receiveObjectTransfer:function(e){},threadInitTLS:function(){P.tlsInitFunctions.forEach(e=>e())},loadWasmModuleToWorker:function(o,i){console.log("loadWasmModuleToWorker"),o.onmessage=e=>{var t,r,e=e.data,n=e.cmd;if(o.pthread_ptr&&(P.currentProxiedOperationCallerThread=o.pthread_ptr),e.targetThread&&e.targetThread!=q())return(t=P.pthreads[e.targetThread])?t.postMessage(e,e.transferList):g(\'Internal error! Worker sent a message "\'+n+\'" to target pthread \'+e.targetThread+", but that thread no longer exists!"),void(P.currentProxiedOperationCallerThread=void 0);"processProxyingQueue"===n?de(e.queue):"spawnThread"===n?ie(e):"cleanupThread"===n?oe(e.thread):"killThread"===n?(t=e.thread,r=P.pthreads[t],delete P.pthreads[t],r.terminate(),We(t),P.runningWorkers.splice(P.runningWorkers.indexOf(r),1),r.pthread_ptr=0):"cancelThread"===n?(r=e.thread,P.pthreads[r].postMessage({cmd:"cancel"})):"loaded"===n?(o.loaded=!0,i&&i(o),o.runPthread&&(o.runPthread(),delete o.runPthread)):"print"===n?D("Thread "+e.threadId+": "+e.text):"printErr"===n?g("Thread "+e.threadId+": "+e.text):"alert"===n?alert("Thread "+e.threadId+": "+e.text):"setimmediate"===e.target?o.postMessage(e):"onAbort"===n?s.onAbort&&s.onAbort(e.arg):n&&g("worker sent an unknown command "+n),P.currentProxiedOperationCallerThread=void 0},o.onerror=e=>{throw g("worker sent an error! "+e.filename+":"+e.lineno+": "+e.message),e},l&&(o.on("message",function(e){o.onmessage({data:e})}),o.on("error",function(e){o.onerror(e)}),o.on("detachedExit",function(){})),console.log("load "+s.mainScriptUrlOrBlob+" | "+Re),o.postMessage({cmd:"load",urlOrBlob:s.mainScriptUrlOrBlob||Re,wasmMemory:h,wasmModule:F})},allocateUnusedWorker:function(){var e=U("jxl_decoder.worker.js");P.unusedWorkers.push(new Worker(e))},getNewWorker:function(){return console.log("getNewWorker"),0==P.unusedWorkers.length&&(P.allocateUnusedWorker(),P.loadWasmModuleToWorker(P.unusedWorkers[0])),P.unusedWorkers.pop()}};function ue(e){for(;0<e.length;)e.shift()(s)}function ce(t){if(_)return R(2,0,t);try{se(t)}catch(e){(t=e)instanceof M||"unwind"==t||o(1,t)}}s.PThread=P,s.establishStackSpace=function(){var e=q(),t=k[e+44>>2],e=k[e+48>>2];Te(t,t-e),Me(t)};var I=[];function le(e){this.excPtr=e,this.ptr=e-24,this.set_type=function(e){A[this.ptr+4>>2]=e},this.get_type=function(){return A[this.ptr+4>>2]},this.set_destructor=function(e){A[this.ptr+8>>2]=e},this.get_destructor=function(){return A[this.ptr+8>>2]},this.set_refcount=function(e){k[this.ptr>>2]=e},this.set_caught=function(e){x[this.ptr+12>>0]=e=e?1:0},this.get_caught=function(){return 0!=x[this.ptr+12>>0]},this.set_rethrown=function(e){x[this.ptr+13>>0]=e=e?1:0},this.get_rethrown=function(){return 0!=x[this.ptr+13>>0]},this.init=function(e,t){this.set_adjusted_ptr(0),this.set_type(e),this.set_destructor(t),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){Atomics.add(k,this.ptr+0>>2,1)},this.release_ref=function(){return 1===Atomics.sub(k,this.ptr+0>>2,1)},this.set_adjusted_ptr=function(e){A[this.ptr+16>>2]=e},this.get_adjusted_ptr=function(){return A[this.ptr+16>>2]},this.get_exception_ptr=function(){if(Ie(this.get_type()))return A[this.excPtr>>2];var e=this.get_adjusted_ptr();return 0!==e?e:this.excPtr}}s.invokeEntryPoint=function(e,t){(r=I[e=e])||(e>=I.length&&(I.length=e+1),I[e]=r=J.get(e));var r,e=r(t);w?P.setExitStatus(e):je(e)};function pe(e,t,r,n){return _?R(3,1,e,t,r,n):_e(e,t,r,n)}function _e(e,t,r,n){if("undefined"==typeof SharedArrayBuffer)return g("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var o=[];if(_&&0===o.length)return pe(e,t,r,n);t={startRoutine:r,pthread_ptr:e,arg:n,transferList:o};return _?(t.cmd="spawnThread",postMessage(t,o),0):ie(t)}function de(e){Atomics.store(k,e>>2,1),q()&&Ae(e),Atomics.compareExchange(k,e>>2,1,0)}function E(e){E.shown||(E.shown={}),E.shown[e]||(E.shown[e]=1,g(e=l?"warning: "+e:e))}function R(o,i){var e,t,a=arguments.length-2,s=arguments;return e=()=>{for(var e=a,t=Pe(8*e),r=t>>3,n=0;n<a;n++)L[r+n]=s[2+n];return ke(o,e,t,i)},t=Se(),e=e(),Me(t),e}s.executeNotifiedProxyingQueue=de;var O=l?()=>{var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:_?()=>performance.now()-s.__performance_now_clock_drift:()=>performance.now(),fe=[];function he(e){return _?R(4,1,e):52}function me(e,t,r,n,o){return _?R(5,1,e,t,r,n,o):70}var ye=[null,[],[]];function ge(e,t,r,n){if(_)return R(6,1,e,t,r,n);for(var o,i,a,s=0,u=0;u<r;u++){var c=A[t>>2],l=A[t+4>>2];t+=8;for(var p=0;p<l;p++)o=e,i=b[c+p],a=void 0,a=ye[o],0===i||10===i?((1===o?D:g)(z(a,0)),a.length=0):a.push(i);s+=l}return A[n>>2]=s,0}P.init();var C,we=[null,ae,ce,pe,he,me,ge],ve={__cxa_allocate_exception:function(e){return xe(e+24)+24},__cxa_throw:function(e,t,r){throw new le(e).init(t,r),e},__emscripten_init_main_thread_js:function(e){be(e,!c,1,!u),P.threadInitTLS()},__emscripten_thread_cleanup:function(e){_?postMessage({cmd:"cleanupThread",thread:e}):oe(e)},__pthread_create_js:_e,_emscripten_default_pthread_stack_size:function(){return 2097152},_emscripten_get_now_is_monotonic:function(){return!0},_emscripten_notify_task_queue:function(e,t,r,n){if(e==t)setTimeout(()=>de(n));else if(_)postMessage({targetThread:e,cmd:"processProxyingQueue",queue:n});else{t=P.pthreads[e];if(!t)return;t.postMessage({cmd:"processProxyingQueue",queue:n})}return 1},_emscripten_set_offscreencanvas_size:function(e,t,r){return-1},abort:function(){T("")},emscripten_check_blocking_allowed:function(){l||c||E("Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread")},emscripten_date_now:function(){return Date.now()},emscripten_get_now:O,emscripten_memcpy_big:function(e,t,r){b.copyWithin(e,t,t+r)},emscripten_receive_on_main_thread_js:function(e,t,r){fe.length=t;for(var n=r>>3,o=0;o<t;o++)fe[o]=L[n+o];return(e<0?ne[-e-1]:we[e]).apply(null,fe)},emscripten_resize_heap:function(e){b.length,T("OOM")},emscripten_unwind_to_js_event_loop:function(){throw"unwind"},exit:se,fd_close:he,fd_seek:me,fd_write:ge,memory:h||s.wasmMemory},xe=(function(){var t={env:ve,wasi_snapshot_preview1:ve};function r(e,t){console.log("receiveInstance");var r,e=e.exports;s.asm=e,e=s.asm._emscripten_tls_init,P.tlsInitFunctions.push(e),J=s.asm.__indirect_function_table,e=s.asm.__wasm_call_ctors,G.unshift(e),F=t,_||(r=P.unusedWorkers.length,P.unusedWorkers.forEach(function(e){P.loadWasmModuleToWorker(e,function(){var e;--r||(W--,s.monitorRunDependencies&&s.monitorRunDependencies(W),0==W&&(null!==$&&(clearInterval($),$=null),j&&(e=j,j=null,e())))})}))}function n(e){r(e.instance,e.module)}function o(e){return function(){if(!f&&(u||c)){if("function"==typeof fetch&&!te(S))return fetch(S,{credentials:"same-origin"}).then(function(e){if(e.ok)return e.arrayBuffer();throw"failed to load wasm binary file at \'"+S+"\'"}).catch(function(){return re(S)});if(a)return new Promise(function(t,e){a(S,function(e){t(new Uint8Array(e))},e)})}return Promise.resolve().then(function(){return re(S)})}().then(function(e){return WebAssembly.instantiate(e,t)}).then(function(e){return e}).then(e,function(e){g("failed to asynchronously prepare wasm: "+e),T(e)})}if(_||(W++,s.monitorRunDependencies&&s.monitorRunDependencies(W)),s.instantiateWasm)try{return s.instantiateWasm(t,r)}catch(e){g("Module.instantiateWasm callback failed with error: "+e),i(e)}(f||"function"!=typeof WebAssembly.instantiateStreaming||ee(S)||te(S)||l||"function"!=typeof fetch?o(n):fetch(S,{credentials:"same-origin"}).then(function(e){return WebAssembly.instantiateStreaming(e,t).then(n,function(e){return g("wasm streaming compile failed: "+e),g("falling back to ArrayBuffer instantiation"),o(n)})})).catch(i)}(),s.___wasm_call_ctors=function(){return(s.___wasm_call_ctors=s.asm.__wasm_call_ctors).apply(null,arguments)},s._jxlCreateInstance=function(){return(s._jxlCreateInstance=s.asm.jxlCreateInstance).apply(null,arguments)},s._jxlDestroyInstance=function(){return(s._jxlDestroyInstance=s.asm.jxlDestroyInstance).apply(null,arguments)},s._free=function(){return(s._free=s.asm.free).apply(null,arguments)},s._jxlProcessInput=function(){return(s._jxlProcessInput=s.asm.jxlProcessInput).apply(null,arguments)},s._malloc=function(){return(xe=s._malloc=s.asm.malloc).apply(null,arguments)}),q=(s._jxlFlush=function(){return(s._jxlFlush=s.asm.jxlFlush).apply(null,arguments)},s.__emscripten_tls_init=function(){return(s.__emscripten_tls_init=s.asm._emscripten_tls_init).apply(null,arguments)},s._pthread_self=function(){return(q=s._pthread_self=s.asm.pthread_self).apply(null,arguments)}),be=(s.___errno_location=function(){return(s.___errno_location=s.asm.__errno_location).apply(null,arguments)},s.__emscripten_thread_init=function(){return(be=s.__emscripten_thread_init=s.asm._emscripten_thread_init).apply(null,arguments)}),ke=(s.__emscripten_thread_crashed=function(){return(s.__emscripten_thread_crashed=s.asm._emscripten_thread_crashed).apply(null,arguments)},s._emscripten_main_thread_process_queued_calls=function(){return(s._emscripten_main_thread_process_queued_calls=s.asm.emscripten_main_thread_process_queued_calls).apply(null,arguments)},s._emscripten_main_browser_thread_id=function(){return(s._emscripten_main_browser_thread_id=s.asm.emscripten_main_browser_thread_id).apply(null,arguments)},s._emscripten_run_in_main_runtime_thread_js=function(){return(ke=s._emscripten_run_in_main_runtime_thread_js=s.asm.emscripten_run_in_main_runtime_thread_js).apply(null,arguments)}),Ae=(s._emscripten_dispatch_to_thread_=function(){return(s._emscripten_dispatch_to_thread_=s.asm.emscripten_dispatch_to_thread_).apply(null,arguments)},s.__emscripten_proxy_execute_task_queue=function(){return(Ae=s.__emscripten_proxy_execute_task_queue=s.asm._emscripten_proxy_execute_task_queue).apply(null,arguments)}),We=s.__emscripten_thread_free_data=function(){return(We=s.__emscripten_thread_free_data=s.asm._emscripten_thread_free_data).apply(null,arguments)},je=s.__emscripten_thread_exit=function(){return(je=s.__emscripten_thread_exit=s.asm._emscripten_thread_exit).apply(null,arguments)},Te=(s._setThrew=function(){return(s._setThrew=s.asm.setThrew).apply(null,arguments)},s._saveSetjmp=function(){return(s._saveSetjmp=s.asm.saveSetjmp).apply(null,arguments)},s._emscripten_stack_set_limits=function(){return(Te=s._emscripten_stack_set_limits=s.asm.emscripten_stack_set_limits).apply(null,arguments)}),Se=s.stackSave=function(){return(Se=s.stackSave=s.asm.stackSave).apply(null,arguments)},Me=s.stackRestore=function(){return(Me=s.stackRestore=s.asm.stackRestore).apply(null,arguments)},Pe=s.stackAlloc=function(){return(Pe=s.stackAlloc=s.asm.stackAlloc).apply(null,arguments)},Ie=s.___cxa_is_pointer_type=function(){return(Ie=s.___cxa_is_pointer_type=s.asm.__cxa_is_pointer_type).apply(null,arguments)};s.dynCall_iiji=function(){return(s.dynCall_iiji=s.asm.dynCall_iiji).apply(null,arguments)},s.dynCall_jiji=function(){return(s.dynCall_jiji=s.asm.dynCall_jiji).apply(null,arguments)};function Ee(){if(!(0<W)){if(_)return r(s),K(),void postMessage({cmd:"loaded"});Y(),0<W||(s.setStatus?(s.setStatus("Running..."),setTimeout(function(){setTimeout(function(){s.setStatus("")},1),e()},1)):e())}function e(){C||(C=!0,s.calledRun=!0,H||(K(),r(s),s.onRuntimeInitialized&&s.onRuntimeInitialized(),Z()))}}if(s.keepRuntimeAlive=V,s.wasmMemory=h,s.ExitStatus=M,s.PThread=P,j=function e(){C||Ee(),C||(j=e)},s.preInit)for("function"==typeof s.preInit&&(s.preInit=[s.preInit]);0<s.preInit.length;)s.preInit.pop()();return Ee(),e.ready}})();"object"==typeof exports&&"object"==typeof module?module.exports=JxlCodecModule:"function"==typeof define&&define.amd?define([],function(){return JxlCodecModule}):"object"==typeof exports&&(exports.JxlCodecModule=JxlCodecModule);',"jxl_decoder.worker.js":'"use strict";var Module={},ENVIRONMENT_IS_NODE="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,nodeWorkerThreads,parentPort,fs,initializedJS=(ENVIRONMENT_IS_NODE&&(nodeWorkerThreads=require("worker_threads"),parentPort=nodeWorkerThreads.parentPort,parentPort.on("message",e=>onmessage({data:e})),fs=require("fs"),Object.assign(global,{self:global,require:require,Module:Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:function(e){(0,eval)(fs.readFileSync(e,"utf8"))},postMessage:function(e){parentPort.postMessage(e)},performance:global.performance||{now:function(){return Date.now()}}})),!1),pendingNotifiedProxyingQueues=[];function threadPrintErr(){var e=Array.prototype.slice.call(arguments).join(" ");ENVIRONMENT_IS_NODE?fs.writeSync(2,e+"\\n"):console.error(e)}function threadAlert(){var e=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:e,threadId:Module._pthread_self()})}var err=threadPrintErr;self.alert=threadAlert,Module.instantiateWasm=(e,r)=>{e=new WebAssembly.Instance(Module.wasmModule,e);return r(e),Module.wasmModule=null,e.exports},self.onunhandledrejection=e=>{throw e.reason??e},self.onmessage=e=>{try{var r;if("load"===e.data.cmd)Module.wasmModule=e.data.wasmModule,Module.wasmMemory=e.data.wasmMemory,Module.buffer=Module.wasmMemory.buffer,Module.ENVIRONMENT_IS_PTHREAD=!0,"string"==typeof e.data.urlOrBlob?importScripts(e.data.urlOrBlob):(r=URL.createObjectURL(e.data.urlOrBlob),importScripts(r),URL.revokeObjectURL(r)),JxlCodecModule(Module).then(function(e){Module=e});else if("run"===e.data.cmd){Module.__performance_now_clock_drift=performance.now()-e.data.time,Module.__emscripten_thread_init(e.data.pthread_ptr,0,0,1),Module.establishStackSpace(),Module.PThread.receiveObjectTransfer(e.data),Module.PThread.threadInitTLS(),initializedJS||(pendingNotifiedProxyingQueues.forEach(e=>{Module.executeNotifiedProxyingQueue(e)}),pendingNotifiedProxyingQueues=[],initializedJS=!0);try{Module.invokeEntryPoint(e.data.start_routine,e.data.arg)}catch(e){if("unwind"!=e){if(!(e instanceof Module.ExitStatus))throw e;Module.keepRuntimeAlive()||Module.__emscripten_thread_exit(e.status)}}}else"cancel"===e.data.cmd?Module._pthread_self()&&Module.__emscripten_thread_exit(-1):"setimmediate"!==e.data.target&&("processProxyingQueue"===e.data.cmd?initializedJS?Module.executeNotifiedProxyingQueue(e.data.queue):pendingNotifiedProxyingQueues.push(e.data.queue):e.data.cmd&&(err("worker.js received unknown command "+e.data.cmd),err(e.data)))}catch(e){throw Module.__emscripten_thread_crashed&&Module.__emscripten_thread_crashed(),e}};'},e=e=>{const t=e.request.url;for(var[r,n]of Object.entries(o))if(t.endsWith(r)){const s=new Headers;return s.set("Content-Type","application/javascript"),(r=s).set("Cross-Origin-Embedder-Policy","require-corp"),r.set("Cross-Origin-Opener-Policy","same-origin"),e.respondWith(new Response(n,{status:200,statusText:"OK",headers:s})),!0}return!1},r=async e=>{let t=new Headers(e.headers);t.append("Accept","image/jxl");e=new Request(e,{headers:t});let r=await fetch(e);return r.headers.get("Content-Type"),r},t=async t=>{if(clients.get(t.clientId).then(e=>{e?e.postMessage({url:t.request.url}):console.log("Ooops! No target for: "+t.request.url)}),("only-if-cached"!==t.request.cache||"same-origin"===t.request.mode)&&!e(t)&&"image"===t.request.destination){let e=t.request.headers.get("Accept");-1===e.indexOf("image/jxl")&&t.respondWith(r(t.request))}},n=()=>self.skipWaiting();if("undefined"!=typeof window){(()=>{if(!window.isSecureContext)return t.log("Secure context is required for this ServiceWorker.");const t={log:console.log,error:console.error,...window.serviceWorkerConfig};navigator.serviceWorker.register(window.document.currentScript.src).then(e=>{t.log("Service Worker registered",e.scope)},e=>{t.error("Service Worker failed to register:",e)})})();{console.log("prepareClient");const s=new Worker("client_worker.js");navigator.serviceWorker.addEventListener("message",e=>{s.postMessage(e.data)})}}else self.addEventListener("install",n),self.addEventListener("activate",e=>e.waitUntil(self.clients.claim())),self.addEventListener("message",e=>{e.data&&"deregister"===e.data.type&&self.registration.unregister().then(()=>self.clients.matchAll()).then(e=>{e.forEach(e=>e.navigate(e.url))})}),self.addEventListener("fetch",t)})();